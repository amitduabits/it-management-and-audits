{
  "domain": "Regulatory Compliance",
  "version": "1.0",
  "description": "Controls addressing compliance with major regulatory frameworks including PCI-DSS v4.0, SOX Section 404 IT General Controls, GDPR data protection requirements, and cross-framework governance controls. Focuses on demonstrable compliance posture, evidence of ongoing monitoring, and regulatory reporting readiness.",
  "framework_references": ["PCI-DSS v4.0", "SOX Section 404", "GDPR Art. 5/25/32", "ISO 27001:2022 A.5.31-A.5.36"],
  "controls": [
    {
      "id": "CO-001",
      "title": "PCI-DSS Scope Definition and Network Segmentation Validation",
      "description": "Verify that the cardholder data environment (CDE) scope is formally defined, documented, and validated. All systems that store, process, or transmit cardholder data, and any systems connected to those systems, must be identified and included in scope. Network segmentation used to reduce PCI-DSS scope must be tested and validated at least annually.",
      "test_procedure": "1. Obtain the PCI-DSS scope documentation including data flow diagrams. 2. Verify all systems that store, process, or transmit cardholder data are identified. 3. Confirm connected-to and security-impacting systems are included in scope. 4. If segmentation is used to reduce scope, verify annual penetration testing validates segmentation effectiveness. 5. Review the most recent segmentation test results and confirm no failures.",
      "expected_evidence": "PCI-DSS scope document, cardholder data flow diagrams, system inventory with CDE classification, segmentation penetration test report, scope validation sign-off",
      "framework_mapping": {
        "PCI-DSS": "Req 1 - Network Security Controls, Scoping Guidance",
        "ISO 27001": "A.5.31 Legal, Statutory, Regulatory Requirements",
        "COBIT": "MEA03.01 Identify External Compliance Requirements"
      },
      "risk_weight": 5
    },
    {
      "id": "CO-002",
      "title": "Cardholder Data Protection and Encryption",
      "description": "Verify that stored cardholder data (CHD) is protected through encryption, truncation, masking, or tokenization. Primary Account Numbers (PAN) must be rendered unreadable anywhere they are stored. Encryption keys must be managed according to PCI-DSS key management requirements with documented key custodians and rotation schedules.",
      "test_procedure": "1. Identify all locations where cardholder data is stored (databases, files, logs, backups). 2. Verify PAN is encrypted, truncated, or tokenized in each storage location. 3. Confirm encryption uses strong algorithms (AES-256 or equivalent). 4. Review key management procedures including dual control, split knowledge, and rotation. 5. Conduct data discovery scan to identify any unprotected cardholder data.",
      "expected_evidence": "Cardholder data storage inventory, encryption configuration evidence, key management procedure documentation, key custodian acknowledgments, data discovery scan results",
      "framework_mapping": {
        "PCI-DSS": "Req 3 - Protect Stored Account Data",
        "ISO 27001": "A.8.24 Use of Cryptography",
        "COBIT": "DSS05.06 Manage Sensitive Documents and Devices"
      },
      "risk_weight": 5
    },
    {
      "id": "CO-003",
      "title": "SOX IT General Controls - Application Change Management",
      "description": "Verify that IT General Controls (ITGCs) over financially significant applications meet SOX Section 404 requirements. Changes to applications that impact financial reporting must be authorized, tested, approved, and implemented with proper segregation of duties. Access to modify production programs must be restricted.",
      "test_procedure": "1. Identify all financially significant applications per the SOX scoping document. 2. For each application, select a sample of 10 changes during the audit period. 3. Verify each change has documented authorization, testing, and approval prior to deployment. 4. Confirm the person who approved the change is different from the developer. 5. Verify that developers do not have production deployment access for SOX applications.",
      "expected_evidence": "SOX application scoping document, sample change tickets with approvals (per application), developer access reports for production, test evidence for sampled changes, ITGC control matrix",
      "framework_mapping": {
        "SOX": "Section 404 - ITGC Change Management",
        "COBIT": "BAI06 Manage Changes",
        "PCAOB": "AS 2201 - IT General Controls"
      },
      "risk_weight": 5
    },
    {
      "id": "CO-004",
      "title": "SOX IT General Controls - Logical Access",
      "description": "Verify that logical access controls over financially significant applications ensure only authorized users have access to financial data and transactions. User access provisioning must be approved, periodic access reviews must be performed, and terminated user access must be revoked in a timely manner.",
      "test_procedure": "1. For each SOX-scoped application, obtain the current user access list. 2. Select a sample of 25 users and verify access was properly authorized. 3. Verify that user access reviews were performed during the audit period. 4. Cross-reference terminated employees against application access to confirm timely revocation. 5. Review segregation of duties controls within financially significant applications.",
      "expected_evidence": "SOX application access lists, access authorization evidence, access review completion records, terminated employee access revocation evidence, SoD analysis results",
      "framework_mapping": {
        "SOX": "Section 404 - ITGC Logical Access",
        "COBIT": "DSS05.04 Manage User Identity and Logical Access",
        "PCAOB": "AS 2201 - IT General Controls"
      },
      "risk_weight": 5
    },
    {
      "id": "CO-005",
      "title": "Data Privacy and Protection Controls (GDPR/Privacy Laws)",
      "description": "Verify that the organization has implemented appropriate technical and organizational measures to protect personal data in compliance with applicable privacy regulations. This includes data inventory and classification, lawful basis for processing, privacy impact assessments, data subject rights fulfillment, and data breach notification procedures.",
      "test_procedure": "1. Obtain the data processing inventory (Record of Processing Activities under GDPR Art. 30). 2. Verify lawful basis is documented for each processing activity. 3. Confirm Data Protection Impact Assessments (DPIAs) were completed for high-risk processing. 4. Test the data subject access request (DSAR) process by reviewing recent requests and fulfillment. 5. Verify data breach notification procedures include regulatory timelines (72 hours for GDPR).",
      "expected_evidence": "Record of Processing Activities, lawful basis documentation, DPIA records, DSAR fulfillment records and response times, breach notification procedure, privacy policy",
      "framework_mapping": {
        "GDPR": "Art. 5, 6, 25, 30, 32, 33, 35",
        "ISO 27001": "A.5.34 Privacy and Protection of PII",
        "COBIT": "APO01.08 Maintain Compliance with Policies and Procedures"
      },
      "risk_weight": 4
    },
    {
      "id": "CO-006",
      "title": "Penetration Testing Program",
      "description": "Verify that the organization conducts regular penetration testing of both internal and external networks, as well as web application penetration testing. Tests should be performed by qualified testers, findings should be risk-rated, and remediation should be tracked to closure. PCI-DSS requires annual external/internal network penetration testing and application-layer testing.",
      "test_procedure": "1. Review the penetration testing program and schedule. 2. Obtain the most recent external and internal penetration test reports. 3. Verify testing was performed by qualified testers (internal or third-party). 4. Confirm all critical and high findings from the most recent test have been remediated. 5. Verify retesting was performed to confirm remediation effectiveness. 6. Confirm testing scope covers all in-scope segments and web applications.",
      "expected_evidence": "Penetration testing policy/schedule, external pen test report, internal pen test report, web application pen test report, remediation tracking with closure evidence, retest results",
      "framework_mapping": {
        "PCI-DSS": "11.4 External and internal penetration testing",
        "ISO 27001": "A.8.8 Management of Technical Vulnerabilities",
        "NIST CSF": "DE.CM-8 Vulnerability scans are performed"
      },
      "risk_weight": 4
    },
    {
      "id": "CO-007",
      "title": "Security Awareness Training Program",
      "description": "Verify that all employees receive security awareness training upon hire and at least annually thereafter. Training should cover phishing awareness, password security, data handling, incident reporting, and social engineering. Specialized training should be provided to personnel with security responsibilities. Training completion rates should be tracked.",
      "test_procedure": "1. Review the security awareness training program and curriculum. 2. Verify training content covers required topics (phishing, data handling, incident reporting). 3. Obtain training completion records for the past 12 months. 4. Calculate and verify completion rate meets target (typically 95%+). 5. Verify that phishing simulation exercises are conducted and results tracked. 6. Confirm specialized training records for IT security staff.",
      "expected_evidence": "Training program documentation, training content/curriculum, completion reports with percentage, phishing simulation results and trend data, specialized training records for security staff",
      "framework_mapping": {
        "PCI-DSS": "12.6 Security awareness program",
        "ISO 27001": "A.6.3 Information Security Awareness, Education and Training",
        "NIST CSF": "PR.AT-1 All users are informed and trained",
        "SOX": "COSO - Control Environment"
      },
      "risk_weight": 3
    },
    {
      "id": "CO-008",
      "title": "Third-Party and Vendor Risk Management",
      "description": "Verify that the organization maintains a vendor risk management program that identifies, assesses, and monitors risks associated with third-party service providers who have access to systems or data. Contracts should include security requirements, right-to-audit clauses, and incident notification obligations. Third-party compliance should be validated through SOC reports, certifications, or assessments.",
      "test_procedure": "1. Obtain the vendor inventory with risk classifications. 2. For high-risk/critical vendors, verify security assessments were performed. 3. Review vendor contracts for security clauses, SLAs, and right-to-audit provisions. 4. Obtain and review SOC 2 Type II reports for critical service providers. 5. Verify that vendor risk assessments are refreshed on a defined schedule (annually for critical vendors).",
      "expected_evidence": "Vendor inventory with risk ratings, vendor security assessments, contract extracts showing security clauses, SOC 2 reports for critical vendors, vendor risk management policy",
      "framework_mapping": {
        "PCI-DSS": "12.8 Manage service provider relationships",
        "ISO 27001": "A.5.19-A.5.22 Supplier Relationships",
        "NIST CSF": "ID.SC Supply Chain Risk Management",
        "SOX": "ITGC - Third-Party Service Provider Management"
      },
      "risk_weight": 4
    },
    {
      "id": "CO-009",
      "title": "Audit Trail and Log Retention Compliance",
      "description": "Verify that audit trails are maintained for all activities on systems within the compliance scope. Logs must be tamper-resistant, retained for the required period (PCI-DSS: 12 months with 3 months immediately available; SOX: 7 years), time-synchronized across systems, and reviewed on a regular basis.",
      "test_procedure": "1. Verify audit logging is enabled on all in-scope systems. 2. Confirm logs capture required events (user access, data changes, admin actions, security events). 3. Verify log retention meets regulatory requirements. 4. Confirm logs are forwarded to a centralized, tamper-resistant repository (SIEM or log management). 5. Verify NTP synchronization across all logging systems. 6. Confirm daily log review process is in place.",
      "expected_evidence": "Logging configuration for in-scope systems, log retention policy and configuration, SIEM/log management platform configuration, NTP synchronization evidence, daily log review procedure and evidence",
      "framework_mapping": {
        "PCI-DSS": "10.1-10.7 Track and monitor all access to network resources and cardholder data",
        "SOX": "ITGC - Audit Trail Requirements",
        "ISO 27001": "A.8.15 Logging",
        "COBIT": "DSS05.07 Monitor Security Events"
      },
      "risk_weight": 4
    },
    {
      "id": "CO-010",
      "title": "Compliance Monitoring and Self-Assessment",
      "description": "Verify that the organization conducts regular self-assessments against applicable compliance frameworks to identify gaps and track remediation. A compliance monitoring program should exist with defined ownership, assessment frequency, and escalation procedures for identified deficiencies. The organization should maintain a compliance calendar tracking key deadlines and deliverables.",
      "test_procedure": "1. Review the compliance monitoring program and governance structure. 2. Obtain the compliance calendar with assessment dates and regulatory deadlines. 3. Verify that self-assessments were completed per schedule for the past 12 months. 4. Review gap analysis results and confirm remediation plans exist for identified gaps. 5. Verify compliance status is reported to senior management or the board on a regular cadence.",
      "expected_evidence": "Compliance monitoring program documentation, compliance calendar, self-assessment reports, gap analysis and remediation plans, management/board compliance reporting evidence, compliance team charter",
      "framework_mapping": {
        "PCI-DSS": "12.4 PCI-DSS compliance management",
        "SOX": "COSO - Monitoring Activities",
        "ISO 27001": "A.5.36 Compliance with Policies, Rules and Standards",
        "COBIT": "MEA03 Monitor, Evaluate, and Assess Compliance"
      },
      "risk_weight": 3
    }
  ]
}
