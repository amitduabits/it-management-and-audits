<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ report_title }}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .page { max-width: 1100px; margin: 0 auto; padding: 30px; }

        .header {
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 50%, #2dd4bf 100%);
            color: white; padding: 40px 50px; border-radius: 16px; margin-bottom: 30px;
        }
        .header h1 { font-size: 2em; margin-bottom: 8px; }
        .header .meta { display: flex; gap: 30px; margin-top: 15px; font-size: 0.85em; opacity: 0.8; }

        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 30px; }
        .summary-card {
            background: white; border-radius: 12px; padding: 24px; text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06);
        }
        .summary-card .num { font-size: 2.2em; font-weight: 700; }
        .summary-card .lbl { font-size: 0.82em; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 4px; }

        .timeline {
            position: relative; padding-left: 40px; margin: 30px 0;
        }
        .timeline::before {
            content: ''; position: absolute; left: 15px; top: 0; bottom: 0;
            width: 3px; background: linear-gradient(to bottom, #14b8a6, #eab308, #6366f1);
            border-radius: 2px;
        }

        .phase {
            position: relative; margin-bottom: 40px;
        }
        .phase-header {
            display: flex; align-items: center; gap: 15px; margin-bottom: 20px;
        }
        .phase-dot {
            width: 32px; height: 32px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; color: white;
            font-weight: 700; font-size: 0.85em; position: absolute; left: -40px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15); z-index: 1;
        }
        .phase-title { font-size: 1.3em; font-weight: 600; }
        .phase-meta { font-size: 0.88em; color: #64748b; }

        .item-card {
            background: white; border-radius: 10px; margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06); overflow: hidden;
            border-left: 4px solid #e2e8f0;
        }
        .item-card.severity-critical { border-left-color: #ef4444; }
        .item-card.severity-high { border-left-color: #f97316; }
        .item-card.severity-medium { border-left-color: #eab308; }
        .item-card.severity-low { border-left-color: #22c55e; }

        .item-header {
            display: flex; align-items: center; gap: 12px; padding: 16px 20px;
        }
        .item-title { flex: 1; font-weight: 600; font-size: 0.95em; }
        .item-badges { display: flex; gap: 8px; flex-shrink: 0; }
        .badge {
            padding: 2px 10px; border-radius: 12px; font-size: 0.75em;
            font-weight: 600; text-transform: uppercase;
        }
        .badge-effort-low { background: #f0fdf4; color: #16a34a; }
        .badge-effort-medium { background: #fffbeb; color: #d97706; }
        .badge-effort-high { background: #fef2f2; color: #dc2626; }
        .badge-hours { background: #f1f5f9; color: #475569; }

        .item-body { padding: 0 20px 16px; }
        .item-body p { font-size: 0.88em; color: #475569; margin-bottom: 8px; }
        .item-body .team { font-size: 0.82em; color: #94a3b8; }
        .item-body .team strong { color: #64748b; }

        .progress-section {
            background: white; border-radius: 12px; padding: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06); margin-bottom: 30px;
        }
        .progress-section h2 { margin-bottom: 20px; font-size: 1.2em; }
        .progress-phase {
            display: flex; align-items: center; gap: 15px; margin-bottom: 16px;
        }
        .progress-label { width: 120px; font-size: 0.88em; font-weight: 600; }
        .progress-bar {
            flex: 1; height: 24px; background: #f1f5f9; border-radius: 12px;
            overflow: hidden; position: relative;
        }
        .progress-bar .fill {
            height: 100%; border-radius: 12px; display: flex;
            align-items: center; padding-left: 12px; font-size: 0.78em;
            color: white; font-weight: 600; min-width: fit-content;
        }
        .progress-count { width: 80px; text-align: right; font-size: 0.88em; color: #64748b; }

        .footer { text-align: center; padding: 25px; color: #94a3b8; font-size: 0.82em; margin-top: 30px; }
        .disclaimer { background: #fffbeb; border: 1px solid #fde68a; border-radius: 8px; padding: 15px 20px; margin-top: 30px; font-size: 0.85em; color: #92400e; }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <h1>{{ report_title }}</h1>
            <p style="opacity:0.9;">Prioritized security improvement plan with effort estimation and team assignments</p>
            <div class="meta">
                <span>Organization: {{ organization }}</span>
                <span>Date: {{ report_date }}</span>
                <span>Report ID: {{ report_id }}</span>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="summary-grid">
            <div class="summary-card">
                <div class="num" style="color:#0f766e;">{{ summary.total_items }}</div>
                <div class="lbl">Total Actions</div>
            </div>
            <div class="summary-card">
                <div class="num" style="color:#14b8a6;">{{ summary.quick_wins_count }}</div>
                <div class="lbl">Quick Wins</div>
            </div>
            <div class="summary-card">
                <div class="num" style="color:#eab308;">{{ summary.short_term_count }}</div>
                <div class="lbl">Short-Term</div>
            </div>
            <div class="summary-card">
                <div class="num" style="color:#6366f1;">{{ summary.long_term_count }}</div>
                <div class="lbl">Long-Term</div>
            </div>
        </div>

        <!-- Progress Overview -->
        <div class="progress-section">
            <h2>Effort Distribution</h2>
            {% set total = summary.total_items if summary.total_items > 0 else 1 %}
            <div class="progress-phase">
                <span class="progress-label">Quick Wins</span>
                <div class="progress-bar">
                    <div class="fill" style="width: {{ (summary.quick_wins_count / total * 100)|round(0) }}%; background: linear-gradient(90deg, #14b8a6, #2dd4bf);">
                        {{ summary.phase_breakdown.quick_wins.hours }}h
                    </div>
                </div>
                <span class="progress-count">0-30 days</span>
            </div>
            <div class="progress-phase">
                <span class="progress-label">Short-Term</span>
                <div class="progress-bar">
                    <div class="fill" style="width: {{ (summary.short_term_count / total * 100)|round(0) }}%; background: linear-gradient(90deg, #eab308, #fbbf24);">
                        {{ summary.phase_breakdown.short_term.hours }}h
                    </div>
                </div>
                <span class="progress-count">30-90 days</span>
            </div>
            <div class="progress-phase">
                <span class="progress-label">Long-Term</span>
                <div class="progress-bar">
                    <div class="fill" style="width: {{ (summary.long_term_count / total * 100)|round(0) }}%; background: linear-gradient(90deg, #6366f1, #818cf8);">
                        {{ summary.phase_breakdown.long_term.hours }}h
                    </div>
                </div>
                <span class="progress-count">90-365 days</span>
            </div>
            <p style="margin-top:15px; font-size:0.88em; color:#64748b;">
                Total estimated effort: <strong>{{ summary.total_estimated_hours }} hours</strong>
                (~{{ summary.estimated_days }} person-days)
            </p>
        </div>

        <!-- Timeline -->
        <div class="timeline">
            <!-- Quick Wins Phase -->
            <div class="phase">
                <div class="phase-dot" style="background: #14b8a6;">1</div>
                <div class="phase-header">
                    <div>
                        <div class="phase-title">Phase 1: Quick Wins</div>
                        <div class="phase-meta">0-30 days | {{ quick_wins|length }} items | Low effort, high impact</div>
                    </div>
                </div>
                {% for item in quick_wins %}
                <div class="item-card severity-{{ item.severity }}">
                    <div class="item-header">
                        <span class="item-title">{{ item.title }}</span>
                        <div class="item-badges">
                            <span class="badge badge-effort-{{ item.effort }}">{{ item.effort }}</span>
                            <span class="badge badge-hours">~{{ item.estimated_hours }}h</span>
                        </div>
                    </div>
                    <div class="item-body">
                        <p>{{ item.remediation_steps }}</p>
                        <div class="team"><strong>Team:</strong> {{ item.responsible_team }}</div>
                    </div>
                </div>
                {% endfor %}
                {% if not quick_wins %}
                <p style="color:#94a3b8; padding:15px 0;">No quick win items identified.</p>
                {% endif %}
            </div>

            <!-- Short-Term Phase -->
            <div class="phase">
                <div class="phase-dot" style="background: #eab308;">2</div>
                <div class="phase-header">
                    <div>
                        <div class="phase-title">Phase 2: Short-Term Actions</div>
                        <div class="phase-meta">30-90 days | {{ short_term|length }} items | Moderate effort</div>
                    </div>
                </div>
                {% for item in short_term %}
                <div class="item-card severity-{{ item.severity }}">
                    <div class="item-header">
                        <span class="item-title">{{ item.title }}</span>
                        <div class="item-badges">
                            <span class="badge badge-effort-{{ item.effort }}">{{ item.effort }}</span>
                            <span class="badge badge-hours">~{{ item.estimated_hours }}h</span>
                        </div>
                    </div>
                    <div class="item-body">
                        <p>{{ item.remediation_steps }}</p>
                        <div class="team"><strong>Team:</strong> {{ item.responsible_team }}</div>
                    </div>
                </div>
                {% endfor %}
                {% if not short_term %}
                <p style="color:#94a3b8; padding:15px 0;">No short-term items identified.</p>
                {% endif %}
            </div>

            <!-- Long-Term Phase -->
            <div class="phase">
                <div class="phase-dot" style="background: #6366f1;">3</div>
                <div class="phase-header">
                    <div>
                        <div class="phase-title">Phase 3: Long-Term Strategy</div>
                        <div class="phase-meta">90-365 days | {{ long_term|length }} items | Strategic improvements</div>
                    </div>
                </div>
                {% for item in long_term %}
                <div class="item-card severity-{{ item.severity }}">
                    <div class="item-header">
                        <span class="item-title">{{ item.title }}</span>
                        <div class="item-badges">
                            <span class="badge badge-effort-{{ item.effort }}">{{ item.effort }}</span>
                            <span class="badge badge-hours">~{{ item.estimated_hours }}h</span>
                        </div>
                    </div>
                    <div class="item-body">
                        <p>{{ item.remediation_steps }}</p>
                        <div class="team"><strong>Team:</strong> {{ item.responsible_team }}</div>
                    </div>
                </div>
                {% endfor %}
                {% if not long_term %}
                <p style="color:#94a3b8; padding:15px 0;">No long-term items identified.</p>
                {% endif %}
            </div>
        </div>

        <div class="disclaimer">
            <strong>Disclaimer:</strong> Effort estimates are approximate and based on typical enterprise environments.
            Actual implementation time may vary based on organizational complexity, existing infrastructure,
            and team capacity. Prioritization should be reviewed with relevant stakeholders.
            This tool is intended for authorized security assessments only.
        </div>

        <div class="footer">
            Generated by SecureAudit Pro | Report ID: {{ report_id }} | {{ report_date }}
        </div>
    </div>
</body>
</html>
